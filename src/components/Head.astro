---
import { SITE } from "../data/site";
import { canonical as resolveCanonical, metaDesc, titleTag } from "../lib/seo";

interface Props {
  title?: string;
  description?: string;
  canonical?: string;
  image?: string;
  type?: "website" | "article";
}

const {
  title,
  description,
  canonical,
  image,
  type = "website",
} = Astro.props as Props;

const baseUrl = SITE.url.replace(/\/+$/, "");
const resolvedTitle = titleTag(title);
const resolvedDesc = metaDesc(description);
const resolvedCanonical =
  canonical ?? resolveCanonical(Astro.url?.pathname ?? "/");
const resolvedImage = image
  ? image.startsWith("http")
    ? image
    : `${baseUrl}${image.startsWith("/") ? image : `/${image}`}`
  : `${baseUrl}/og.jpg`;
---
<title>{resolvedTitle}</title>
<meta name="description" content={resolvedDesc} />
<link rel="canonical" href={resolvedCanonical} />
<meta property="og:site_name" content={SITE.title} />
<meta property="og:type" content={type} />
<meta property="og:title" content={resolvedTitle} />
<meta property="og:description" content={resolvedDesc} />
<meta property="og:url" content={resolvedCanonical} />
<meta property="og:image" content={resolvedImage} />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content={resolvedTitle} />
<meta name="twitter:description" content={resolvedDesc} />
<meta name="twitter:image" content={resolvedImage} />
