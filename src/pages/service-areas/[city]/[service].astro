---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { ALL_CITIES, SERVICES, SITE } from "../../../data/site";

export const prerender = true;

// Generate all city x service paths explicitly
export function getStaticPaths() {
  return ALL_CITIES.flatMap((c) =>
    SERVICES.map((s) => ({
      params: { city: c.slug, service: s.slug },
      props: { city: c, svc: s }
    }))
  );
}

const { city, svc } = Astro.props;

// Basic SEO (inherits site-wide head tags from BaseLayout)
const pageTitle = `${svc.name} in ${city.name} | ${SITE.name}`;
const desc = `${svc.name} for ${city.name}, CA â€” ${SITE.name}. USPS-compliant installs, repairs, ADA and parcel lockers.`;
const url = new URL(Astro.url.pathname, SITE.url).toString();

// Minimal schema (optional; safe to include)
const schema = {
  "@context": "https://schema.org",
  "@type": "Service",
  name: svc.name,
  areaServed: city.name + ", CA",
  provider: { "@type": "LocalBusiness", name: SITE.name, telephone: SITE.phone, url: SITE.url }
};
---
<BaseLayout title={pageTitle} description={desc} url={url} schema={schema}>
  <main class="max-w-4xl mx-auto p-6 space-y-6">
    <h1 class="text-2xl font-semibold">{svc.name} in {city.name}</h1>
    <p class="text-gray-700">{desc}</p>

    {svc.blurb && <p class="text-gray-700">{svc.blurb}</p>}
    {Array.isArray(svc.bullets) && svc.bullets.length > 0 && (
      <ul class="list-disc pl-6 space-y-1">
        {svc.bullets.map((b) => <li>{b}</li>)}
      </ul>
    )}

    <section class="mt-6">
      <h2 class="text-xl font-semibold">Also serving San Diego County</h2>
      <p class="text-gray-700">We primarily serve San Diego County cities and also take projects in Temecula, Riverside County and Orange County.</p>
    </section>
  </main>
</BaseLayout>
