---
import SiteLayout from "../../../layouts/SiteLayout.astro"
import Breadcrumbs from "../../../components/Breadcrumbs.astro"
import CTA from "../../../components/ui/CTA.astro"
import SectionHeader from "../../../components/ui/SectionHeader.astro"
import TrustGrid from "../../../components/TrustGrid.astro"
import ProcessStrip from "../../../components/ProcessStrip.astro"

export async function getStaticPaths() {
  const areas = (await import("../../../data/areas.json")).default as any[]
  const paths = areas.map((c: any) => {
    const cityName = c.city ?? c.name
    const state = c.state ?? "CA"
    const citySlug = String(cityName)
      .toLowerCase()
      .replace(/[^a-z0-9]+/g, "-")
      .replace(/(^-|-$)/g, "")
    return {
      params: { city: citySlug },
      props: { c: { city: cityName, state } },
    }
  })
  return paths
}

const { c } = Astro.props as { c: { city: string; state: string } }

const citySlug = String(c.city)
  .toLowerCase()
  .replace(/[^a-z0-9]+/g, "-")
  .replace(/(^-|-$)/g, "")

const title = `Mailbox Services in ${c.city} — Postal Systems`
const desc = `USPS-approved commercial mailbox services in ${c.city}, ${c.state}.`
const canonical = `https://sandiegocommercialmailboxes.com/service-areas/${citySlug}/`

const services = (await import("../../../data/services.json")).default as {
  name: string
}[]

export const prerender = true
---
<SiteLayout {title} description={desc} canonical={canonical}>
  <main class="max-w-6xl mx-auto px-4 lg:px-6 py-10 lg:py-12">
    <Breadcrumbs
      crumbs={[
        { href: "/", label: "Home" },
        { href: "/service-areas/", label: "Service Areas" },
        { href: canonical, label: c.city },
      ]}
    />

    <section class="mt-4">
      <p
        class="text-[11px] font-semibold tracking-[0.2em] uppercase text-ps-navy/70"
      >
        Service areas · {c.state}
      </p>
      <h1
        class="mt-2 text-3xl md:text-4xl font-semibold tracking-tight text-ps-navy"
      >
        Mailbox services in {c.city}
      </h1>
      <p class="mt-2 text-sm md:text-base text-ps-navy/80 max-w-2xl">
        {desc} Choose a compliant, USPS-approved installer for HOAs,
        apartments, builders, and commercial sites in {c.city}.
      </p>
    </section>

    <section class="mt-6">
      <h2 class="text-sm font-semibold text-ps-navy">Available services</h2>
      <p class="mt-1 text-xs text-ps-navy/80">
        Choose a mailbox service in {c.city}.
      </p>
      <ul class="mt-4 grid md:grid-cols-2 gap-3 text-sm">
        {services.map((s) => {
          const serviceSlug = String(s.name)
            .toLowerCase()
            .replace(/[^a-z0-9]+/g, "-")
            .replace(/(^-|-$)/g, "")
          return (
            <li>
              <a
                class="underline hover:text-ps-red"
                href={`/service-areas/${citySlug}/${serviceSlug}/`}
              >
                {s.name} in {c.city}
              </a>
            </li>
          )
        })}
      </ul>
    </section>

    <section class="mt-10">
      <SectionHeader
        title={`Why properties in ${c.city} work with Postal Systems`}
        subtitle="Local, USPS-approved contractor focused on compliant commercial mailbox systems."
        align="left"
      />
      <div class="mt-4">
        <TrustGrid />
      </div>
    </section>

    <div class="mt-10">
      <ProcessStrip
        subtitle={`From site visit in ${c.city} through USPS inspection and key handover, we manage the entire mailbox project.`}
      />
    </div>

    <section class="mt-12 mb-4">
      <div
        class="rounded-3xl bg-white shadow-ps border border-ps-muted px-5 py-6 md:px-8 md:py-7"
      >
        <h2 class="text-base md:text-lg font-semibold text-ps-navy">
          Get a USPS-approved quote
        </h2>
        <p class="mt-1 text-sm text-ps-navy/80">
          Fast, compliant installs with inspection sign-off.
        </p>
        <div class="mt-4 flex flex-wrap gap-3">
          <a
            href="tel:16194614787"
            class="inline-flex items-center justify-center rounded-full bg-ps-navy px-5 py-2.5 text-sm font-semibold text-white shadow-md hover:bg-ps-navy/90 transition"
          >
            Call (619) 461-4787
          </a>
          <a
            href="/contact/"
            class="inline-flex items-center justify-center rounded-full border border-ps-navy/20 bg-white px-5 py-2.5 text-sm font-semibold text-ps-navy hover:bg-ps-navy hover:text-white transition"
          >
            Request a quote
          </a>
        </div>
      </div>
    </section>
  </main>
</SiteLayout>
