---
import SiteLayout from "../../layouts/SiteLayout.astro"
import Breadcrumbs from "../../components/Breadcrumbs.astro"
import CTA from "../../components/ui/CTA.astro"
import SectionHeader from "../../components/ui/SectionHeader.astro"
import TrustGrid from "../../components/TrustGrid.astro"
import ProcessStrip from "../../components/ProcessStrip.astro"
import { slugify } from "../../lib/slug"

export async function getStaticPaths() {
  const services = (await import("../../data/services.json")).default as {
    name: string
    summary?: string
    content?: string
  }[]

  return services.map((s) => ({
    params: { service: slugify(s.name) },
    props: { service: s },
  }))
}

const { service } = Astro.props as {
  service: { name: string; summary?: string; content?: string }
}

const serviceSlug = slugify(service.name)

const areas = (await import("../../data/areas.json")).default as {
  city: string
  state?: string
  county?: string
}[]

const primaryAreas = areas.filter((a) => a.county === "San Diego County")
const featuredAreas = (primaryAreas.length ? primaryAreas : areas).slice(0, 6)

const title = `${service.name} — Mailbox Services | Postal Systems`
const desc =
  service.summary ||
  `USPS-approved ${service.name.toLowerCase()} for HOAs, apartments, and commercial properties in San Diego County.`
const canonical = `https://sandiegocommercialmailboxes.com/services/${serviceSlug}/`

export const prerender = true
---
<SiteLayout {title} description={desc} canonical={canonical}>
  <main class="max-w-6xl mx-auto px-4 lg:px-6 py-10 lg:py-12">
    <Breadcrumbs
      crumbs={[
        { href: "/", label: "Home" },
        { href: "/services/", label: "Services" },
        { href: canonical, label: service.name },
      ]}
    />

    <section
      class="mt-6 grid gap-8 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1fr)] items-start"
    >
      <div>
        <p
          class="text-[11px] font-semibold tracking-[0.2em] uppercase text-ps-navy/70"
        >
          Mailbox services · San Diego County
        </p>
        <h1
          class="mt-2 text-3xl md:text-4xl font-semibold tracking-tight text-ps-navy"
        >
          {service.name}
        </h1>
        <p class="mt-3 text-sm md:text-base text-ps-navy/85 max-w-xl">
          {desc}
        </p>
        <ul class="mt-4 space-y-1.5 text-sm text-ps-navy/85">
          <li>• USPS-approved installation and coordination.</li>
          <li>• Pads, anchors, mounting, and ADA-compliant layouts.</li>
          <li>• Tenant notices and USPS inspections managed for you.</li>
          <li>• Ideal for HOAs, apartments, builders, and facilities.</li>
        </ul>
        <div class="mt-6 flex flex-wrap gap-3">
          <a
            href="/contact/"
            class="inline-flex items-center justify-center rounded-full bg-ps-red px-5 py-2.5 text-sm font-semibold text-white shadow-md hover:bg-ps-red/90 transition"
          >
            Get a USPS-approved quote
          </a>
          <a
            href="tel:16194614787"
            class="inline-flex items-center justify-center rounded-full border border-ps-navy/20 bg-white px-5 py-2.5 text-sm font-semibold text-ps-navy hover:bg-ps-navy hover:text-white transition"
          >
            Call (619) 461-4787
          </a>
        </div>
      </div>

      <aside
        class="rounded-3xl bg-white shadow-ps border border-ps-muted px-5 py-5 md:px-6 md:py-6"
      >
        <h2 class="text-sm font-semibold text-ps-navy">Projects we help with</h2>
        <p class="mt-2 text-xs text-ps-navy/80">
          From new construction to retrofit replacements, Postal Systems
          designs and installs {service.name.toLowerCase()} that meet USPS and
          ADA requirements.
        </p>
        <ul class="mt-3 space-y-1.5 text-xs text-ps-navy/85">
          <li>• New multifamily developments and HOAs.</li>
          <li>• Existing communities needing replacements.</li>
          <li>• Commercial, industrial, and campus properties.</li>
        </ul>
        <div class="mt-5">
          <CTA primaryHref="/contact/" primaryLabel="Request a quote" />
        </div>
      </aside>
    </section>

    {service.content && (
      <section class="mt-10">
        <SectionHeader
          title={`Details about our ${service.name.toLowerCase()}`}
          subtitle="From layout and foundations to USPS approvals."
          align="left"
        />
        <div
          class="prose max-w-none mt-4 text-ps-navy/90"
          set:html={service.content}
        ></div>
      </section>
    )}

    <section class="mt-10">
      <SectionHeader
        title={`Where we provide ${service.name.toLowerCase()}`}
        subtitle="Serving San Diego County first, with select nearby markets."
        align="left"
      />
      <ul class="mt-4 grid gap-4 md:grid-cols-3 text-sm">
        {featuredAreas.map((a) => {
          const citySlug = String(a.city)
            .toLowerCase()
            .replace(/[^a-z0-9]+/g, "-")
            .replace(/(^-|-$)/g, "")
          return (
            <li
              class="rounded-2xl border border-ps-muted bg-white px-4 py-3 shadow-ps"
            >
              <a
                href={`/service-areas/${citySlug}/${serviceSlug}/`}
                class="font-semibold text-ps-navy hover:text-ps-red"
              >
                {service.name} in {a.city}
              </a>
              <p class="mt-1 text-xs text-ps-navy/80">
                Professional {service.name.toLowerCase()} in {a.city}
                {a.state ? `, ${a.state}` : ""}.
              </p>
            </li>
          )
        })}
      </ul>
    </section>

    <section class="mt-12">
      <SectionHeader
        title={`Why Postal Systems for ${service.name.toLowerCase()}?`}
        subtitle="Local, USPS-approved contractor focused on compliant commercial mailbox systems."
        align="left"
      />
      <div class="mt-4">
        <TrustGrid />
      </div>
    </section>

    <div class="mt-10">
      <ProcessStrip
        subtitle={`From site visit through USPS inspection and key handover, we manage the entire ${service.name.toLowerCase()} project.`}
      />
    </div>

    <section class="mt-12 mb-4">
      <div
        class="rounded-3xl bg-white shadow-ps border border-ps-muted px-5 py-6 md:px-8 md:py-7"
      >
        <h2 class="text-base md:text-lg font-semibold text-ps-navy">
          Get a USPS-approved quote
        </h2>
        <p class="mt-1 text-sm text-ps-navy/80">
          Fast, compliant installs with inspection sign-off.
        </p>
        <div class="mt-4 flex flex-wrap gap-3">
          <a
            href="tel:16194614787"
            class="inline-flex items-center justify-center rounded-full bg-ps-navy px-5 py-2.5 text-sm font-semibold text-white shadow-md hover:bg-ps-navy/90 transition"
          >
            Call (619) 461-4787
          </a>
          <a
            href="/contact/"
            class="inline-flex items-center justify-center rounded-full border border-ps-navy/20 bg-white px-5 py-2.5 text-sm font-semibold text-ps-navy hover:bg-ps-navy hover:text-white transition"
          >
            Request a quote
          </a>
        </div>
      </div>
    </section>
  </main>
</SiteLayout>
